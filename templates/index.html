<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>2CM SmartBuild - AI-Powered Construction Estimator</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <img src="/static/images/logo.png" alt="2CM SmartBuild Logo" class="logo">
    {% if current_user.is_authenticated %}
        <a href="/logout">Logout</a>
        <a href="/estimates">Estimates</a>
    {% else %}
        <h2>Login</h2>
        <form method="POST" action="/login">
            <input type="text" name="username" placeholder="Username" required><br>
            <input type="password" name="password" placeholder="Password" required><br>
            <button type="submit">Login</button>
        </form>
        <h2>Register</h2>
        <form method="POST" action="/register">
            <input type="text" name="username" placeholder="Username" required><br>
            <input type="password" name="password" placeholder="Password" required><br>
            <button type="submit">Register</button>
        </form>
    {% endif %}
    <h2>Estimate Form</h2>
    <form id="estimateForm">
        <input type="text" id="projectName" placeholder="Project Name" required><br>
        <input type="number" id="timeFrameDays" placeholder="Time Frame (Days)" required><br>
        {% for element in elements %}
            <div>
                <label>{{ element.Element }} ({{ element.Unit }})</label>
                <input type="number" id="quantity_{{ element.Element }}" placeholder="Quantity" min="0" step="0.1">
                <input type="number" id="people_{{ element.Element }}" placeholder="People" min="1" value="1">
            </div>
        {% endfor %}
        <button type="submit">Calculate</button>
    </form>
    <div id="results" style="display:none;">
        <table id="resultsTable">
            <thead><tr><th>Element</th><th>Quantity</th><th>Unit</th><th>Cost (£)</th><th>Time (Days)</th><th>Time (Weeks)</th><th>People</th><th>Allocated Days</th></tr></thead>
            <tbody></tbody>
        </table>
        <p>Total Cost: <span id="totalCost">£0</span></p>
        <p>Maximum Simultaneous Workers: <span id="maxWorkers">0</span></p>
        <canvas id="costChart" class="chart"></canvas>
        <canvas id="timeChart" class="chart"></canvas>
        <canvas id="laborChart" class="chart"></canvas>
        <a id="downloadLink" href="#" download>Download PDF</a>
    </div>
    <div id="progressForm" style="display:none;">
        <h3>Update Progress</h3>
        <select id="progressElement"></select>
        <input type="number" id="progressDays" placeholder="Days Completed" min="0">
        <button onclick="updateProgress()">Update</button>
    </div>
    <script src="/static/js/script.js"></script>
</body>
</html>